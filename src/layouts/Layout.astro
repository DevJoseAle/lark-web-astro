---
// src/layouts/Layout.astro
import "../styles/global.css";
import { translations, type Language } from "../i18n/translations";

interface Props {
  title: string;
  description?: string;
  lang?: Language;
  image?: string; // ðŸ‘ˆ NUEVO
}

const { 
  title, 
  description, 
  lang = "en",
  image = "/og-image.jpg" // ðŸ‘ˆ NUEVO: imagen por defecto
} = Astro.props;

const t = translations[lang];
const currentPath = Astro.url.pathname;

// ðŸ‘‡ NUEVO: URLs absolutas para SEO
const canonicalURL = new URL(Astro.url.pathname, Astro.site);
const ogImageURL = new URL(image, Astro.site);

// ðŸ‘‡ NUEVO: URLs alternativas para hreflang
const enPath = currentPath.replace('/es', '') || '/';
const esPath = currentPath.startsWith('/es') ? currentPath : `/es${currentPath}`;
---


<!doctype html>
<html lang={lang}>
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    
    <!-- Favicon -->
    <link rel="icon" type="image/svg+xml" href="/Logo.png" />
    
    <!-- ðŸ‘‡ NUEVO: Apple Touch Icon -->
    <link rel="apple-touch-icon" sizes="180x180" href="/Logo.png" />
    
    <meta name="generator" content={Astro.generator} />

    <!-- ========== SEO BÃSICO ========== -->
    <title>{title}</title>
    <meta name="description" content={description || t.hero.subtitle} />
    
    <!-- ðŸ‘‡ NUEVO: Theme Color -->
    <meta name="theme-color" content="#007AFF" />
    <link rel="manifest" href="/manifest.json" />
    <!-- ========== CANONICAL & HREFLANG (CRÃTICO) ========== -->
    <!-- ðŸ‘‡ NUEVO: Evita contenido duplicado -->
    <link rel="canonical" href={canonicalURL} />
    
    <!-- ðŸ‘‡ NUEVO: Multi-idioma para Google -->
    <link rel="alternate" hreflang="en" href={new URL(enPath, Astro.site)} />
    <link rel="alternate" hreflang="es" href={new URL(esPath, Astro.site)} />
    <link rel="alternate" hreflang="x-default" href={new URL(enPath, Astro.site)} />

    <!-- ========== OPEN GRAPH (Facebook, LinkedIn, WhatsApp) ========== -->
    <!-- ðŸ‘‡ NUEVO: Completo -->
    <meta property="og:type" content="website" />
    <meta property="og:url" content={canonicalURL} />
    <meta property="og:title" content={title} />
    <meta property="og:description" content={description || t.hero.subtitle} />
    <meta property="og:image" content={ogImageURL} />
    <meta property="og:image:width" content="1200" />
    <meta property="og:image:height" content="630" />
    <meta property="og:site_name" content="L-ark" />
    <meta property="og:locale" content={lang === "es" ? "es_ES" : "en_US"} />

    <!-- ========== TWITTER CARDS ========== -->
    <!-- ðŸ‘‡ NUEVO: Para Twitter/X -->
    <meta name="twitter:card" content="summary_large_image" />
    <meta name="twitter:title" content={title} />
    <meta name="twitter:description" content={description || t.hero.subtitle} />
    <meta name="twitter:image" content={ogImageURL} />
    <!-- ðŸ‘‡ Opcional: Cuando tengas Twitter -->
    <!-- <meta name="twitter:site" content="@lark" /> -->

    <!-- ========== PRECONNECT (Performance) ========== -->
    <!-- ðŸ‘‡ NUEVO: Conecta antes a recursos externos -->
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link rel="dns-prefetch" href="https://kluftwmjexljwvzftlse.supabase.co" />

    <!-- ========== STRUCTURED DATA (JSON-LD) ========== -->
    <!-- ðŸ‘‡ NUEVO: Schema.org para Google -->
    <script type="application/ld+json" set:html={JSON.stringify({
      "@context": "https://schema.org",
      "@type": "Organization",
      "name": "L-ark",
      "url": Astro.site,
      "logo": new URL("/Logo.png", Astro.site),
      "description": lang === "es" 
        ? "Plataforma de herencia digital y recaudaciÃ³n de fondos"
        : "Digital inheritance and crowdfunding platform",
      "contactPoint": {
        "@type": "ContactPoint",
        "email": "dh.lark.25@gmail.com",
        "contactType": "Customer Service",
        "availableLanguage": ["English", "Spanish"]
      },
      "sameAs": [
        "https://instagram.com/lark",
        "https://linkedin.com/company/lark"
      ]
    })} />
  </head>
  <body>
    <!-- Language Selector (fixed) -->
    <div class="lang-selector">
      <a href="/" class={lang === "en" ? "active" : ""}>EN</a>
      <span class="separator">|</span>
      <a href="/es" class={lang === "es" ? "active" : ""}>ES</a>
    </div>

    <!-- Header/Navigation -->
    <header class="header">
      <nav class="nav">
        <a href={lang === "es" ? "/es" : "/"} class="logo">
          <img src="/Logo.png" alt="L-ark" width="60" height="60" />
          <span>L-ark</span>
        </a>

        <div class="nav-links">
          <a
            href={lang === "es" ? "/es" : "/"}
            class={currentPath === "/" || currentPath === "/es" ? "active" : ""}
            >{t.nav.home}</a
          >
          <a
            href={lang === "es" ? "/es/donate" : "/donate"}
            class={currentPath.includes("/donate") ? "active" : ""}
            >{t.nav.donate}</a
          >
          <a
            href={lang === "es" ? "/es/terms" : "/terms"}
            class={currentPath.includes("/terms") ? "active" : ""}
            >{t.nav.terms}</a
          >
          <a
            href={lang === "es" ? "/es/contact" : "/contact"}
            class={currentPath.includes("/contact") ? "active" : ""}
            >{t.nav.contact}</a
          >
        </div>

        <a href="#download" class="cta-button">
          {t.nav.downloadApp}
        </a>
      </nav>
    </header>

    <!-- Main Content -->
    <main class="main">
      <slot />
    </main>
<!-- Footer -->
    <footer class="footer">
      <div class="footer-content">
        <div class="footer-brand">
          <div class="logo-footer">
           <img src="/Logo.png" alt="L-ark" width="100" height="100" />
            <span>L-ark</span>
          </div>
          <p class="footer-description">{t.footer.description}</p>
        </div>

        <div class="footer-section">
          <h4>{t.footer.links}</h4>
          <a href={lang === "es" ? "/es" : "/"}>{t.nav.home}</a>
          <a href={lang === "es" ? "/es/donate" : "/donate"}>{t.nav.donate}</a>
          <a href={lang === "es" ? "/es/terms" : "/terms"}>{t.nav.terms}</a>
          <a href={lang === "es" ? "/es/contact" : "/contact"}
            >{t.nav.contact}</a
          >
        </div>

        <div class="footer-section">
          <h4>{t.footer.legal}</h4>
          <a href={lang === "es" ? "/es/privacy" : "/privacy"}
            >{t.footer.privacy}</a
          >
          <a href={lang === "es" ? "/es/terms" : "/terms"}
            >{t.footer.termsOfService}</a
          >
        </div>

        <div class="footer-section">
          <h4>{t.footer.followUs}</h4>
          <div class="social-links">
            <!-- LinkedIn -->
            <a href="https://www.linkedin.com/company/l-ark/" target="_blank" rel="noopener noreferrer" aria-label="LinkedIn">
              <svg
                width="20"
                height="20"
                fill="currentColor"
                viewBox="0 0 24 24"
              >
                <path
                  d="M20.447 20.452h-3.554v-5.569c0-1.328-.027-3.037-1.852-3.037-1.853 0-2.136 1.445-2.136 2.939v5.667H9.351V9h3.414v1.561h.046c.477-.9 1.637-1.85 3.37-1.85 3.601 0 4.267 2.37 4.267 5.455v6.286zM5.337 7.433c-1.144 0-2.063-.926-2.063-2.065 0-1.138.92-2.063 2.063-2.063 1.14 0 2.064.925 2.064 2.063 0 1.139-.925 2.065-2.064 2.065zm1.782 13.019H3.555V9h3.564v11.452zM22.225 0H1.771C.792 0 0 .774 0 1.729v20.542C0 23.227.792 24 1.771 24h20.451C23.2 24 24 23.227 24 22.271V1.729C24 .774 23.2 0 22.222 0h.003z"
                ></path>
              </svg>
            </a>
            <!-- Instagram -->
            <a href="https://instagram.com/l.ark.app" target="_blank" rel="noopener noreferrer" aria-label="Instagram">
              <svg
                width="20"
                height="20"
                fill="currentColor"
                viewBox="0 0 24 24"
              >
                <path
                  d="M12 0C8.74 0 8.333.015 7.053.072 5.775.132 4.905.333 4.14.63c-.789.306-1.459.717-2.126 1.384S.935 3.35.63 4.14C.333 4.905.131 5.775.072 7.053.012 8.333 0 8.74 0 12s.015 3.667.072 4.947c.06 1.277.261 2.148.558 2.913.306.788.717 1.459 1.384 2.126.667.666 1.336 1.079 2.126 1.384.766.296 1.636.499 2.913.558C8.333 23.988 8.74 24 12 24s3.667-.015 4.947-.072c1.277-.06 2.148-.262 2.913-.558.788-.306 1.459-.718 2.126-1.384.666-.667 1.079-1.335 1.384-2.126.296-.765.499-1.636.558-2.913.06-1.28.072-1.687.072-4.947s-.015-3.667-.072-4.947c-.06-1.277-.262-2.149-.558-2.913-.306-.789-.718-1.459-1.384-2.126C21.319 1.347 20.651.935 19.86.63c-.765-.297-1.636-.499-2.913-.558C15.667.012 15.26 0 12 0zm0 2.16c3.203 0 3.585.016 4.85.071 1.17.055 1.805.249 2.227.415.562.217.96.477 1.382.896.419.42.679.819.896 1.381.164.422.36 1.057.413 2.227.057 1.266.07 1.646.07 4.85s-.015 3.585-.074 4.85c-.061 1.17-.256 1.805-.421 2.227-.224.562-.479.96-.899 1.382-.419.419-.824.679-1.38.896-.42.164-1.065.36-2.235.413-1.274.057-1.649.07-4.859.07-3.211 0-3.586-.015-4.859-.074-1.171-.061-1.816-.256-2.236-.421-.569-.224-.96-.479-1.379-.899-.421-.419-.69-.824-.9-1.38-.165-.42-.359-1.065-.42-2.235-.045-1.26-.061-1.649-.061-4.844 0-3.196.016-3.586.061-4.861.061-1.17.255-1.814.42-2.234.21-.57.479-.96.9-1.381.419-.419.81-.689 1.379-.898.42-.166 1.051-.361 2.221-.421 1.275-.045 1.65-.06 4.859-.06l.045.03zm0 3.678c-3.405 0-6.162 2.76-6.162 6.162 0 3.405 2.76 6.162 6.162 6.162 3.405 0 6.162-2.76 6.162-6.162 0-3.405-2.76-6.162-6.162-6.162zM12 16c-2.21 0-4-1.79-4-4s1.79-4 4-4 4 1.79 4 4-1.79 4-4 4zm7.846-10.405c0 .795-.646 1.44-1.44 1.44-.795 0-1.44-.646-1.44-1.44 0-.794.646-1.439 1.44-1.439.793-.001 1.44.645 1.44 1.439z"
                ></path>
              </svg>
            </a>
            <!-- Threads -->
            <a href="https://threads.net/@l.ark.app" target="_blank" rel="noopener noreferrer" aria-label="Threads">
              <svg
                width="20"
                height="20"
                fill="currentColor"
                viewBox="0 0 24 24"
              >
                <path
                  d="M12.186 24h-.007c-3.581-.024-6.334-1.205-8.184-3.509C2.35 18.44 1.5 15.586 1.472 12.01v-.017c.03-3.579.879-6.43 2.525-8.482C5.845 1.205 8.6.024 12.18 0h.014c2.746.02 5.043.725 6.826 2.098 1.677 1.29 2.858 3.13 3.509 5.467l-2.04.569c-1.104-3.96-3.898-5.984-8.304-6.015-2.91.022-5.11.936-6.54 2.717C4.307 6.504 3.616 8.914 3.59 12c.025 3.086.718 5.496 2.057 7.164 1.43 1.783 3.631 2.698 6.54 2.717 2.623-.02 4.358-.631 5.8-2.045 1.647-1.613 1.618-3.593 1.09-4.798-.31-.71-.873-1.3-1.634-1.75-.192 1.352-.622 2.446-1.284 3.272-.886 1.102-2.14 1.704-3.73 1.79-1.202.065-2.361-.218-3.259-.801-1.063-.689-1.685-1.74-1.752-2.96-.065-1.182.408-2.256 1.332-3.023.88-.73 2.082-1.146 3.381-1.177.9-.02 1.758.07 2.563.27-.067-.682-.228-1.243-.482-1.678-.537-.917-1.523-1.382-2.932-1.382h-.08c-1.339.047-2.317.553-2.913 1.508l-1.735-1.14C6.585 5.78 8.362 4.898 10.602 4.834c.078-.002.16-.003.24-.003 2.108 0 3.723.627 4.803 1.867.916 1.052 1.424 2.503 1.512 4.317a9.963 9.963 0 0 1 1.675.695c1.061.57 1.898 1.38 2.422 2.344.703 1.293.955 3.114.136 5.114-1.07 2.612-3.463 4.32-6.937 4.94-.636.113-1.387.18-2.267.18zm.057-8.652c-.06 0-.122.002-.184.004-.953.026-1.74.272-2.276.713-.494.407-.728.927-.697 1.545.036.66.36 1.205.938 1.58.612.398 1.4.56 2.215.52 1.092-.058 1.925-.47 2.476-1.224.466-.636.753-1.473.855-2.49a8.715 8.715 0 0 0-3.327-.648z"
                ></path>
              </svg>
            </a>
          </div>
        </div>
      </div>

      <div class="footer-bottom">
        <p>{t.footer.copyright}</p>
        <p class="footer-made-with">{t.footer.madeWith}</p>
      </div>
    </footer>
  </body>
</html>

<style>
  .lang-selector {
    position: fixed;
    top: 20px;
    right: 20px;
    z-index: 2000;
    background: rgba(26, 43, 74, 0.95);
    backdrop-filter: blur(10px);
    padding: 0.5rem 1rem;
    border-radius: var(--radius-full);
    border: 1px solid rgba(255, 255, 255, 0.1);
    display: flex;
    align-items: center;
    gap: 0.5rem;
    font-size: 0.875rem;
    font-weight: 600;
  }

  .lang-selector a {
    color: rgba(255, 255, 255, 0.6);
    text-decoration: none;
    transition: color var(--transition-base);
  }

  .lang-selector a.active {
    color: var(--blue-primary);
  }

  .lang-selector a:hover {
    color: white;
  }

  .lang-selector .separator {
    color: rgba(255, 255, 255, 0.3);
  }

  .header {
    background: rgba(26, 43, 74, 0.95);
    backdrop-filter: blur(10px);
    border-bottom: 1px solid rgba(255, 255, 255, 0.1);
    position: sticky;
    top: 0;
    z-index: 1000;
  }

  .nav {
    max-width: 1200px;
    margin: 0 auto;
    padding: 1rem 2rem;
    display: flex;
    justify-content: space-between;
    align-items: center;
  }

  .logo {
    display: flex;
    align-items: center;
    gap: 0.75rem;
    font-size: 1.5rem;
    font-weight: 700;
    color: white;
    text-decoration: none;
    transition: transform var(--transition-base);
  }

  .logo:hover {
    transform: scale(1.05);
  }

  .logo svg {
    color: var(--blue-primary);
  }

  .nav-links {
    display: flex;
    gap: 2rem;
    align-items: center;
  }

  .nav-links a {
    color: rgba(255, 255, 255, 0.8);
    font-weight: 500;
    text-decoration: none;
    transition: color var(--transition-base);
    position: relative;
  }

  .nav-links a:hover {
    color: white;
  }

  .nav-links a.active {
    color: var(--blue-primary);
  }

  .nav-links a.active::after {
    content: "";
    position: absolute;
    bottom: -4px;
    left: 0;
    right: 0;
    height: 2px;
    background: var(--blue-primary);
    border-radius: 2px;
  }

  .cta-button {
    background: var(--blue-primary);
    color: white;
    padding: 0.625rem 1.5rem;
    border-radius: var(--radius-full);
    font-weight: 600;
    text-decoration: none;
    transition: all var(--transition-base);
  }

  .cta-button:hover {
    background: var(--blue-light);
    transform: translateY(-2px);
    box-shadow: 0 8px 24px rgba(0, 122, 255, 0.3);
  }

  .main {
    min-height: calc(100vh - 400px);
  }

  .footer {
    background: var(--navy-primary);
    border-top: 1px solid rgba(255, 255, 255, 0.1);
    color: rgba(255, 255, 255, 0.8);
    margin-top: 6rem;
  }

  .footer-content {
    max-width: 1200px;
    margin: 0 auto;
    padding: 4rem 2rem;
    display: grid;
    grid-template-columns: 2fr 1fr 1fr 1fr;
    gap: 3rem;
  }

  .footer-brand {
    max-width: 300px;
  }

  .logo-footer {
    display: flex;
    align-items: center;
    gap: 0.75rem;
    font-size: 1.5rem;
    font-weight: 700;
    color: white;
    margin-bottom: 1rem;
  }

  .logo-footer svg {
    color: var(--blue-primary);
  }

  .footer-description {
    color: rgba(255, 255, 255, 0.7);
    line-height: 1.6;
    font-size: 0.9375rem;
  }

  .footer-section h4 {
    color: white;
    font-size: 1rem;
    font-weight: 600;
    margin-bottom: 1rem;
  }

  .footer-section a {
    display: block;
    color: rgba(255, 255, 255, 0.7);
    margin-bottom: 0.75rem;
    text-decoration: none;
    transition: color var(--transition-base);
    font-size: 0.9375rem;
  }

  .footer-section a:hover {
    color: var(--blue-primary);
  }

  .social-links {
    display: flex;
    gap: 1rem;
  }

  .social-links a {
    width: 40px;
    height: 40px;
    background: rgba(255, 255, 255, 0.1);
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
    transition: all var(--transition-base);
  }

  .social-links a:hover {
    background: var(--blue-primary);
    transform: translateY(-2px);
  }

  .footer-bottom {
    border-top: 1px solid rgba(255, 255, 255, 0.1);
    padding: 2rem;
    text-align: center;
    color: rgba(255, 255, 255, 0.6);
    font-size: 0.875rem;
  }

  .footer-made-with {
    margin-top: 0.5rem;
    color: rgba(255, 255, 255, 0.5);
  }

  @media (max-width: 1024px) {
    .footer-content {
      grid-template-columns: 1fr 1fr;
    }

    .footer-brand {
      max-width: 100%;
      grid-column: 1 / -1;
    }
  }

  @media (max-width: 768px) {
    .nav {
      flex-direction: column;
      gap: 1rem;
      padding: 1rem;
    }

    .nav-links {
      flex-wrap: wrap;
      justify-content: center;
      gap: 1rem;
    }

    .cta-button {
      width: 100%;
      text-align: center;
    }

    .footer-content {
      grid-template-columns: 1fr;
      text-align: center;
      gap: 2rem;
    }

    .social-links {
      justify-content: center;
    }

    .lang-selector {
      top: 10px;
      right: 10px;
      font-size: 0.75rem;
      padding: 0.4rem 0.8rem;
    }
  }
</style>
